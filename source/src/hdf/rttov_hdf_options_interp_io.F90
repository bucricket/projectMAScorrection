!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
module rttov_hdf_options_interp_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_options_interp_def
!use rttov_hdf_options_interp_mem
use rttov_types
use rttov_const, only :interp_rochon

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_options_interp_init
public :: rttov_hdf_options_interp_rh
public :: rttov_hdf_options_interp_wh


contains


subroutine rttov_hdf_options_interp_init(x)
type(rttov_opts_interp),intent(inout)::x

  x%ADDINTERP=.FALSE.
  x%SPACETOP=.TRUE.
  x%LGRADP=.FALSE.
  x%REG_LIMIT_EXTRAP=.FALSE.
  x%INTERP_MODE=interp_rochon
end subroutine

subroutine rttov_hdf_options_interp_rh(x,lun,err)
type(rttov_opts_interp),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_options_interp_init(x)

sname='ADDINTERP'
call read_array_hdf(lun,sname,err,l0=x%ADDINTERP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SPACETOP'
call read_array_hdf(lun,sname,err,l0=x%SPACETOP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LGRADP'
call read_array_hdf(lun,sname,err,l0=x%LGRADP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REG_LIMIT_EXTRAP'
call read_array_hdf(lun,sname,err,l0=x%REG_LIMIT_EXTRAP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='INTERP_MODE'
call read_array_hdf(lun,sname,err,i0=x%INTERP_MODE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_options_interp_wh(x,lun,err,compress)
type(rttov_opts_interp),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
character(len=lensh)::sname

TRY
sname='ADDINTERP'
call write_array_hdf(lun,sname,&
  & 'Input profiles may be supplied on user-defined levels',&
  & err,l0=x%ADDINTERP  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SPACETOP'
call write_array_hdf(lun,sname,&
  & 'Treat user s model-top as space boundary',&
  & err,l0=x%SPACETOP  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='LGRADP'
call write_array_hdf(lun,sname,&
  & 'Allow TL/AD of user pressure levels if addinterp is true',&
  & err,l0=x%LGRADP  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='REG_LIMIT_EXTRAP'
call write_array_hdf(lun,sname,&
  & 'extrapolate top profile levels using regression limits where input top level is below coef top level',&
  & err,l0=x%REG_LIMIT_EXTRAP  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='INTERP_MODE'
call write_array_hdf(lun,sname,&
  & 'Interpolation mode (see user guide for options)',&
  & err,i0=x%INTERP_MODE  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

err=0_jpim
CATCH
end subroutine

end module
