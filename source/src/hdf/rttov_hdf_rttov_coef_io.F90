!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
module rttov_hdf_rttov_coef_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_rttov_coef_def
!use rttov_hdf_rttov_coef_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_rttov_coef_init
public :: rttov_hdf_rttov_coef_rh
public :: rttov_hdf_rttov_coef_wh


contains


subroutine rttov_hdf_rttov_coef_init(x)
type(rttov_coef),intent(inout)::x

  x%ID_PLATFORM=0_jpim
  x%ID_SAT=0_jpim
  x%ID_INST=0_jpim
  x%ID_SENSOR=0_jpim
  x%ID_COMP_LVL=0_jpim
  x%ID_COMP_PC=0_jpim
  x%ID_CREATION_DATE=0_jpim
  x%ID_CREATION=''
  x%ID_COMMON_NAME=''
  x%LINE_BY_LINE=''
  x%FMV_MODEL_DEF=''
  x%FMV_MODEL_VER=0_jpim
  x%FMV_ORI_NCHN=0_jpim
  x%FMV_CHN=0_jpim
  x%FMV_GAS=0_jpim
  nullify(x%FMV_GAS_ID)
  nullify(x%FMV_GAS_POS)
  nullify(x%FMV_VAR)
  nullify(x%FMV_COE)
  nullify(x%FMV_INT)
  nullify(x%FMV_LVL)
  x%INCZEEMAN=.false.
  x%NMIXED=0_jpim
  x%NWATER=0_jpim
  x%NOZONE=0_jpim
  x%NWVCONT=0_jpim
  x%NCO2=0_jpim
  x%NN2O=0_jpim
  x%NCO=0_jpim
  x%NCH4=0_jpim
  x%NLEVELS=0_jpim
  x%NLAYERS=0_jpim
  x%NCMIXED=0_jpim
  x%NCWATER=0_jpim
  x%NCOZONE=0_jpim
  x%NCWVCONT=0_jpim
  x%NCCO2=0_jpim
  x%NCN2O=0_jpim
  x%NCCO=0_jpim
  x%NCCH4=0_jpim
  x%NINTMIXED=0_jpim
  x%NINTWATER=0_jpim
  x%NINTOZONE=0_jpim
  x%NINTWVCONT=0_jpim
  x%NINTCO2=0_jpim
  x%NINTN2O=0_jpim
  x%NINTCO=0_jpim
  x%NINTCH4=0_jpim
  nullify(x%GAZ_UNITS)
  x%README_SRF=''
  nullify(x%FF_ORI_CHN)
  nullify(x%FF_VAL_CHN)
  nullify(x%FF_CWN)
  nullify(x%FF_BCO)
  nullify(x%FF_BCS)
  nullify(x%FF_GAM)
  nullify(x%TT_CHN)
  nullify(x%TT_VAL_CHN)
  nullify(x%TT_CWN)
  nullify(x%TT_A0)
  nullify(x%TT_A1)
  nullify(x%PW_CHN)
  nullify(x%PW_VAL_CHN)
  nullify(x%SS_CHN)
  nullify(x%SS_VAL_CHN)
  nullify(x%SS_CWN)
  nullify(x%SS_SOLAR_SPECTRUM)
  nullify(x%WOC_CHN)
  nullify(x%WOC_CWN)
  nullify(x%WOC_WAOPC_OW)
  nullify(x%WOC_WAOPC_FW)
  x%WS_NOMEGA=1_JPIM
  nullify(x%WS_NPOINT)
  nullify(x%WS_K_OMEGA)
  x%FC_PLANCK_C1=0._jprb
  x%FC_PLANCK_C2=0._jprb
  x%FC_SAT_HEIGHT=0._jprb
  x%FASTEM_VER=0_jpim
  nullify(x%FASTEM_POLAR)
  x%SSIREM_VER=0_jpim
  nullify(x%SSIREM_CHN)
  nullify(x%SSIREM_A0)
  nullify(x%SSIREM_A1)
  nullify(x%SSIREM_A2)
  nullify(x%SSIREM_XZN1)
  nullify(x%SSIREM_XZN2)
  nullify(x%REF_PRFL_P)
  nullify(x%REF_PRFL_T)
  nullify(x%REF_PRFL_MR)
  nullify(x%LIM_PRFL_P)
  nullify(x%LIM_PRFL_TMAX)
  nullify(x%LIM_PRFL_TMIN)
  nullify(x%LIM_PRFL_GMAX)
  nullify(x%LIM_PRFL_GMIN)
  nullify(x%MIXEDGASINT)
  nullify(x%WATERVAPOURINT)
  nullify(x%OZONEINT)
  nullify(x%WVCONTINT)
  nullify(x%CO2INT)
  nullify(x%N2OINT)
  nullify(x%COINT)
  nullify(x%CH4INT)
  x%PMC_LENGTHCELL=0._jprb
  nullify(x%PMC_PNOMINAL)
  x%PMC_TEMPCELL=0._jprb
  x%PMC_BETAPLUS1=0._jprb
  x%PMC_NLAY=0_jpim
  x%PMC_NVAR=0_jpim
  nullify(x%PMC_COEF)
  nullify(x%PMC_PPMC)
  x%RATOE=0._jprb
  x%NINTN2O=0_jpim
  x%SOLARCOEF=.false.
  x%NLTECOEF=.false.
  x%PMC_SHIFT=.false.
  nullify(x%PLANCK1)
  nullify(x%PLANCK2)
  nullify(x%FREQUENCY_GHZ)
  nullify(x%DP)
  nullify(x%DPP)
  nullify(x%TSTAR)
  nullify(x%TO3STAR)
  nullify(x%WSTAR)
  nullify(x%OSTAR)
  nullify(x%CO2STAR)
  nullify(x%N2OSTAR)
  nullify(x%COSTAR)
  nullify(x%CH4STAR)
end subroutine

subroutine rttov_hdf_rttov_coef_rh(x,lun,err)
type(rttov_coef),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_rttov_coef_init(x)

sname='ID_PLATFORM'
call read_array_hdf(lun,sname,err,i0=x%ID_PLATFORM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_SAT'
call read_array_hdf(lun,sname,err,i0=x%ID_SAT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_INST'
call read_array_hdf(lun,sname,err,i0=x%ID_INST)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_SENSOR'
call read_array_hdf(lun,sname,err,i0=x%ID_SENSOR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_COMP_LVL'
call read_array_hdf(lun,sname,err,i0=x%ID_COMP_LVL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_COMP_PC'
call read_array_hdf(lun,sname,err,i0=x%ID_COMP_PC)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_CREATION_DATE'
call read_array_hdf(lun,sname,err,i1=x%ID_CREATION_DATE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_CREATION'
call read_array_hdf(lun,sname,err,c0=x%ID_CREATION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_COMMON_NAME'
call read_array_hdf(lun,sname,err,c0=x%ID_COMMON_NAME)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LINE_BY_LINE'
call read_array_hdf(lun,sname,err,c1=x%LINE_BY_LINE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_MODEL_DEF'
call read_array_hdf(lun,sname,err,c0=x%FMV_MODEL_DEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_MODEL_VER'
call read_array_hdf(lun,sname,err,i0=x%FMV_MODEL_VER)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))


sname='FMV_CHN'
call read_array_hdf(lun,sname,err,i0=x%FMV_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_GAS'
call read_array_hdf(lun,sname,err,i0=x%FMV_GAS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_GAS_ID'
call read_array_hdf(lun,sname,err,pi1=x%FMV_GAS_ID)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_GAS_POS'
call read_array_hdf(lun,sname,err,pi1=x%FMV_GAS_POS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_VAR'
call read_array_hdf(lun,sname,err,pi1=x%FMV_VAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_COE'
call read_array_hdf(lun,sname,err,pi1=x%FMV_COE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_INT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%FMV_INT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FMV_LVL'
call read_array_hdf(lun,sname,err,pi1=x%FMV_LVL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='INCZEEMAN'
call read_array_hdf(lun,sname,err,l0=x%INCZEEMAN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))



























sname='GAZ_UNITS'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%GAZ_UNITS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='README_SRF'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,c1=x%README_SRF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FF_ORI_CHN'
call read_array_hdf(lun,sname,err,pi1=x%FF_ORI_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_VAL_CHN'
call read_array_hdf(lun,sname,err,pi1=x%FF_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_CWN'
call read_array_hdf(lun,sname,err,pr1=x%FF_CWN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_BCO'
call read_array_hdf(lun,sname,err,pr1=x%FF_BCO)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_BCS'
call read_array_hdf(lun,sname,err,pr1=x%FF_BCS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_GAM'
call read_array_hdf(lun,sname,err,pr1=x%FF_GAM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='TT_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%TT_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TT_VAL_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%TT_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TT_CWN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%TT_CWN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TT_A0'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%TT_A0)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TT_A1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%TT_A1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PW_CHN'
call read_array_hdf(lun,sname,err,pi1=x%PW_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='PW_VAL_CHN'
call read_array_hdf(lun,sname,err,pi1=x%PW_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SS_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%SS_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SS_VAL_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%SS_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SS_CWN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SS_CWN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SS_SOLAR_SPECTRUM'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SS_SOLAR_SPECTRUM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WOC_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%WOC_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WOC_CWN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%WOC_CWN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WOC_WAOPC_OW'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf_cmplx(lun,sname,err,pk1=x%WOC_WAOPC_OW)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WOC_WAOPC_FW'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf_cmplx(lun,sname,err,pk1=x%WOC_WAOPC_FW)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WS_NOMEGA'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%WS_NOMEGA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WS_NPOINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%WS_NPOINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WS_K_OMEGA'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%WS_K_OMEGA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FC_PLANCK_C1'
call read_array_hdf(lun,sname,err,r0=x%FC_PLANCK_C1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FC_PLANCK_C2'
call read_array_hdf(lun,sname,err,r0=x%FC_PLANCK_C2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FC_SAT_HEIGHT'
call read_array_hdf(lun,sname,err,r0=x%FC_SAT_HEIGHT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FASTEM_VER'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%FASTEM_VER)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FASTEM_POLAR'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%FASTEM_POLAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_VER'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%SSIREM_VER)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%SSIREM_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_A0'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_A0)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_A1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_A1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_A2'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_A2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_XZN1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_XZN1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_XZN2'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_XZN2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='REF_PRFL_P'
call read_array_hdf(lun,sname,err,pr1=x%REF_PRFL_P)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REF_PRFL_T'
call read_array_hdf(lun,sname,err,pr2=x%REF_PRFL_T)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REF_PRFL_MR'
call read_array_hdf(lun,sname,err,pr2=x%REF_PRFL_MR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LIM_PRFL_P'
call read_array_hdf(lun,sname,err,pr1=x%LIM_PRFL_P)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LIM_PRFL_TMAX'
call read_array_hdf(lun,sname,err,pr1=x%LIM_PRFL_TMAX)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LIM_PRFL_TMIN'
call read_array_hdf(lun,sname,err,pr1=x%LIM_PRFL_TMIN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LIM_PRFL_GMAX'
call read_array_hdf(lun,sname,err,pr2=x%LIM_PRFL_GMAX)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LIM_PRFL_GMIN'
call read_array_hdf(lun,sname,err,pr2=x%LIM_PRFL_GMIN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='MIXEDGASINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%MIXEDGASINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WATERVAPOURINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%WATERVAPOURINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='OZONEINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%OZONEINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WVCONTINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%WVCONTINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CO2INT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%CO2INT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='N2OINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%N2OINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='COINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%COINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CH4INT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%CH4INT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif




sname='PMC_LENGTHCELL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%PMC_LENGTHCELL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_PNOMINAL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%PMC_PNOMINAL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_TEMPCELL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%PMC_TEMPCELL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_BETAPLUS1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%PMC_BETAPLUS1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_NLAY'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%PMC_NLAY)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_NVAR'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%PMC_NVAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_COEF'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr3=x%PMC_COEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif




















err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_rttov_coef_wh(x,lun,err,compress)
type(rttov_coef),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
character(len=lensh)::sname

TRY
sname='ID_PLATFORM'
call write_array_hdf(lun,sname,&
  & 'Platform Id, see documentation',&
  & err,i0=x%ID_PLATFORM  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_SAT'
call write_array_hdf(lun,sname,&
  & 'Satellite Id, see documentation',&
  & err,i0=x%ID_SAT  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_INST'
call write_array_hdf(lun,sname,&
  & 'Instrument Id, see documentation',&
  & err,i0=x%ID_INST  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_SENSOR'
call write_array_hdf(lun,sname,&
  & 'Sensor Id,  1 = Infrared, 2 = Micro Wave, 3 = High resolution',&
  & err,i0=x%ID_SENSOR  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_COMP_LVL'
call write_array_hdf(lun,sname,&
  & 'RTTOV coefficient file version number',&
  & err,i0=x%ID_COMP_LVL  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_COMP_PC'
call write_array_hdf(lun,sname,&
  & 'Principal component coefficient file version number',&
  & err,i0=x%ID_COMP_PC  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_CREATION_DATE'
call write_array_hdf(lun,sname,&
  & 'Creation Date YYYY MM DD',&
  & err,i1=x%ID_CREATION_DATE  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_CREATION'
call write_array_hdf(lun,sname,&
  & 'Creation comment',&
  & err,c0=x%ID_CREATION  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_COMMON_NAME'
call write_array_hdf(lun,sname,&
  & 'Usual name of the satellite',&
  & err,c0=x%ID_COMMON_NAME  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='LINE_BY_LINE'
call write_array_hdf(lun,sname,&
  & 'Line-by-Line information',&
  & err,c1=x%LINE_BY_LINE  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_MODEL_DEF'
call write_array_hdf(lun,sname,&
  & 'Fast model predictors definition (RTTOV6 OPTRAN RTTOV7)',&
  & err,c0=x%FMV_MODEL_DEF  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_MODEL_VER'
call write_array_hdf(lun,sname,&
  & 'fast model version compatibility level',&
  & err,i0=x%FMV_MODEL_VER  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))


sname='FMV_CHN'
call write_array_hdf(lun,sname,&
  & 'Number of channels read into coef structure',&
  & err,i0=x%FMV_CHN  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_GAS'
call write_array_hdf(lun,sname,&
  & 'Number of gases in file',&
  & err,i0=x%FMV_GAS  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_GAS_ID'
if(associated(x%FMV_GAS_ID))then
  call write_array_hdf(lun,sname,&
    & 'Gaz Id numebr in gas_id list',&
    & err,i1=x%FMV_GAS_ID  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_GAS_POS'
if(associated(x%FMV_GAS_POS))then
  call write_array_hdf(lun,sname,&
    & 'Respective position of each gas of gas_id list',&
    & err,i1=x%FMV_GAS_POS  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_VAR'
if(associated(x%FMV_VAR))then
  call write_array_hdf(lun,sname,&
    & 'number of variables/predictors by gaz',&
    & err,i1=x%FMV_VAR  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_COE'
if(associated(x%FMV_COE))then
  call write_array_hdf(lun,sname,&
    & 'number of coefficients by gaz',&
    & err,i1=x%FMV_COE  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_INT'
if(associated(x%FMV_INT))then
  call write_array_hdf(lun,sname,&
    & 'number of spectral intervals by gaz',&
    & err,i1=x%FMV_INT  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_LVL'
if(associated(x%FMV_LVL))then
  call write_array_hdf(lun,sname,&
    & 'number of levels(pres/absorber) by gaz',&
    & err,i1=x%FMV_LVL  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='INCZEEMAN'
call write_array_hdf(lun,sname,&
  & 'Flag to include Zeeman effect for this sensor',&
  & err,l0=x%INCZEEMAN  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))



























sname='GAZ_UNITS'
if(associated(x%GAZ_UNITS))then
  call write_array_hdf(lun,sname,&
    & 'Unit of gaz concentration for each gaz. Default value is specific conc. (kg/kg) value inside RTTOV calculations (ppmv)',&
    & err,i1=x%GAZ_UNITS  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='README_SRF'
call write_array_hdf(lun,sname,&
  & 'About filter functions used',&
  & err,c1=x%README_SRF  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FF_ORI_CHN'
if(associated(x%FF_ORI_CHN))then
  call write_array_hdf(lun,sname,&
    & 'original chan number',&
    & err,i1=x%FF_ORI_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_VAL_CHN'
if(associated(x%FF_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & 'validity of the channel (1=OK)',&
    & err,i1=x%FF_VAL_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_CWN'
if(associated(x%FF_CWN))then
  call write_array_hdf(lun,sname,&
    & 'cental wave number (cm-1)',&
    & err,r1=x%FF_CWN , units = 'cm^-1' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_BCO'
if(associated(x%FF_BCO))then
  call write_array_hdf(lun,sname,&
    & 'band correction offset (K)',&
    & err,r1=x%FF_BCO , units = 'K' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_BCS'
if(associated(x%FF_BCS))then
  call write_array_hdf(lun,sname,&
    & 'band correction slope (K/K)',&
    & err,r1=x%FF_BCS , units = 'K/K' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_GAM'
if(associated(x%FF_GAM))then
  call write_array_hdf(lun,sname,&
    & 'gamma factor transm. correction',&
    & err,r1=x%FF_GAM  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_CHN'
if(associated(x%TT_CHN))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold channel',&
    & err,i1=x%TT_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_VAL_CHN'
if(associated(x%TT_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold channel validity',&
    & err,i1=x%TT_VAL_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_CWN'
if(associated(x%TT_CWN))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold central wave number',&
    & err,r1=x%TT_CWN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_A0'
if(associated(x%TT_A0))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold A0',&
    & err,r1=x%TT_A0  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_A1'
if(associated(x%TT_A1))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold A1',&
    & err,r1=x%TT_A1  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='PW_CHN'
if(associated(x%PW_CHN))then
  call write_array_hdf(lun,sname,&
    & 'Planck Weighted channel',&
    & err,i1=x%PW_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='PW_VAL_CHN'
if(associated(x%PW_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & '0 => non-PW thermal coefs, 1 => PW thermal coefs',&
    & err,i1=x%PW_VAL_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_CHN'
if(associated(x%SS_CHN))then
  call write_array_hdf(lun,sname,&
    & 'SOLAR_SPECTRUM section',&
    & err,i1=x%SS_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_VAL_CHN'
if(associated(x%SS_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & '0 => thermal, 1 => thermal+solar , 2=> solar',&
    & err,i1=x%SS_VAL_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_CWN'
if(associated(x%SS_CWN))then
  call write_array_hdf(lun,sname,&
    & 'Central wavenumber',&
    & err,r1=x%SS_CWN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_SOLAR_SPECTRUM'
if(associated(x%SS_SOLAR_SPECTRUM))then
  call write_array_hdf(lun,sname,&
    & 'Solar spectrum value',&
    & err,r1=x%SS_SOLAR_SPECTRUM  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WOC_CHN'
if(associated(x%WOC_CHN))then
  call write_array_hdf(lun,sname,&
    & 'Water optical constants channels',&
    & err,i1=x%WOC_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WOC_CWN'
if(associated(x%WOC_CWN))then
  call write_array_hdf(lun,sname,&
    & 'Water optical constants central wave numbers',&
    & err,r1=x%WOC_CWN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WOC_WAOPC_OW'
if(associated(x%WOC_WAOPC_OW))then
  call write_array_hdf_cmplx(lun,sname,&
    & 'Water optical constants ocean water',&
    & err,k1=x%WOC_WAOPC_OW  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WOC_WAOPC_FW'
if(associated(x%WOC_WAOPC_FW))then
  call write_array_hdf_cmplx(lun,sname,&
    & 'Water optical constants fresh water',&
    & err,k1=x%WOC_WAOPC_FW  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WS_NOMEGA'
call write_array_hdf(lun,sname,&
  & 'Size of WAVE_SPECTRUM arrays',&
  & err,i0=x%WS_NOMEGA  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='WS_NPOINT'
if(associated(x%WS_NPOINT))then
  call write_array_hdf(lun,sname,&
    & 'Pulsation for waves at the surface of water',&
    & err,r1=x%WS_NPOINT , units = 'rad s-1' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WS_K_OMEGA'
if(associated(x%WS_K_OMEGA))then
  call write_array_hdf(lun,sname,&
    & 'Wavenumber (for water waves)',&
    & err,r1=x%WS_K_OMEGA , units = 'm-1' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FC_PLANCK_C1'
call write_array_hdf(lun,sname,&
  & 'first radiation constant',&
  & err,r0=x%FC_PLANCK_C1 , units = 'mW/(m2*sr*cm-4)' )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FC_PLANCK_C2'
call write_array_hdf(lun,sname,&
  & 'Second radiation constant',&
  & err,r0=x%FC_PLANCK_C2 , units = 'cm*K' )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FC_SAT_HEIGHT'
call write_array_hdf(lun,sname,&
  & 'Satellite nominal altitude',&
  & err,r0=x%FC_SAT_HEIGHT , units = 'km' )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FASTEM_VER'
call write_array_hdf(lun,sname,&
  & 'Fastem version number',&
  & err,i0=x%FASTEM_VER  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FASTEM_POLAR'
if(associated(x%FASTEM_POLAR))then
  call write_array_hdf(lun,sname,&
    & 'polarisation of each channel',&
    & err,i1=x%FASTEM_POLAR , units = ' 0= 0.5 V+H   1= 90 - incident angle  2= incident angle   3= V  4= H 5= V+H Full Stokes' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_VER'
call write_array_hdf(lun,sname,&
  & 'ISEM version number',&
  & err,i0=x%SSIREM_VER  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SSIREM_CHN'
if(associated(x%SSIREM_CHN))then
  call write_array_hdf(lun,sname,&
    & 'ISEM Channel',&
    & err,i1=x%SSIREM_CHN  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_A0'
if(associated(x%SSIREM_A0))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef a0',&
    & err,r1=x%SSIREM_A0  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_A1'
if(associated(x%SSIREM_A1))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef a1',&
    & err,r1=x%SSIREM_A1  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_A2'
if(associated(x%SSIREM_A2))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef a2',&
    & err,r1=x%SSIREM_A2  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_XZN1'
if(associated(x%SSIREM_XZN1))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef xzn1',&
    & err,r1=x%SSIREM_XZN1  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_XZN2'
if(associated(x%SSIREM_XZN2))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef xzn2',&
    & err,r1=x%SSIREM_XZN2  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REF_PRFL_P'
if(associated(x%REF_PRFL_P))then
  call write_array_hdf(lun,sname,&
    & 'Reference profile pressure',&
    & err,r1=x%REF_PRFL_P , units = 'hPa' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REF_PRFL_T'
if(associated(x%REF_PRFL_T))then
  call write_array_hdf(lun,sname,&
    & 'Reference profile temperature',&
    & err,r2=x%REF_PRFL_T , units = 'K' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REF_PRFL_MR'
if(associated(x%REF_PRFL_MR))then
  call write_array_hdf(lun,sname,&
    & 'Reference profile gaz concentration',&
    & err,r2=x%REF_PRFL_MR , units = 'ppmv' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='LIM_PRFL_P'
if(associated(x%LIM_PRFL_P))then
  call write_array_hdf(lun,sname,&
    & 'Limits pressure',&
    & err,r1=x%LIM_PRFL_P , units = 'hPa' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='LIM_PRFL_TMAX'
if(associated(x%LIM_PRFL_TMAX))then
  call write_array_hdf(lun,sname,&
    & 'Maximum temperature limit',&
    & err,r1=x%LIM_PRFL_TMAX , units = 'K' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='LIM_PRFL_TMIN'
if(associated(x%LIM_PRFL_TMIN))then
  call write_array_hdf(lun,sname,&
    & 'Minimum temperature limit',&
    & err,r1=x%LIM_PRFL_TMIN , units = 'K' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='LIM_PRFL_GMAX'
if(associated(x%LIM_PRFL_GMAX))then
  call write_array_hdf(lun,sname,&
    & 'Maximum gaz concentraion limit (levels, gases)',&
    & err,r2=x%LIM_PRFL_GMAX , units = 'ppmv' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='LIM_PRFL_GMIN'
if(associated(x%LIM_PRFL_GMIN))then
  call write_array_hdf(lun,sname,&
    & 'Minimum gaz concentration limit (levels, gases)',&
    & err,r2=x%LIM_PRFL_GMIN , units = 'ppmv' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='MIXEDGASINT'
if(associated(x%MIXEDGASINT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%MIXEDGASINT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WATERVAPOURINT'
if(associated(x%WATERVAPOURINT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%WATERVAPOURINT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='OZONEINT'
if(associated(x%OZONEINT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%OZONEINT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WVCONTINT'
if(associated(x%WVCONTINT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%WVCONTINT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CO2INT'
if(associated(x%CO2INT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%CO2INT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='N2OINT'
if(associated(x%N2OINT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%N2OINT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='COINT'
if(associated(x%COINT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%COINT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CH4INT'
if(associated(x%CH4INT))then
  call write_array_hdf(lun,sname,&
    & 'to be removed',&
    & err,r2=x%CH4INT , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif




sname='PMC_LENGTHCELL'
call write_array_hdf(lun,sname,&
  & 'Cell length',&
  & err,r0=x%PMC_LENGTHCELL , units = 'cm' )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_PNOMINAL'
if(associated(x%PMC_PNOMINAL))then
  call write_array_hdf(lun,sname,&
    & 'Nominal cell pressure',&
    & err,r1=x%PMC_PNOMINAL , units = 'hPa' )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='PMC_TEMPCELL'
call write_array_hdf(lun,sname,&
  & 'Cell temperature',&
  & err,r0=x%PMC_TEMPCELL , units = 'K' )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_BETAPLUS1'
call write_array_hdf(lun,sname,&
  & 'CO2 band-average: self-HW/air-HW',&
  & err,r0=x%PMC_BETAPLUS1 , units = 'N/A' )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_NLAY'
call write_array_hdf(lun,sname,&
  & 'Number of layers used',&
  & err,i0=x%PMC_NLAY  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_NVAR'
call write_array_hdf(lun,sname,&
  & 'Number of variables used',&
  & err,i0=x%PMC_NVAR  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_COEF'
if(associated(x%PMC_COEF))then
  call write_array_hdf(lun,sname,&
    & 'PMC cell corrections',&
    & err,r3=x%PMC_COEF , units = 'N/A' ,compress=compress)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif




















err=0_jpim
CATCH
end subroutine

end module
